import React, { useState, useContext, useEffect } from 'react';
import { useSpring, animated } from 'react-spring';
import styled from 'styled-components';
import ThemeContext from 'context/ThemeContext';
import media from 'styles/media';

const Container = styled(animated.span)`
  cursor: pointer;
  height: 6rem;
  margin-left: 0.5rem;
  position: absolute;
  top: 1.6rem;
  width: 6rem;
  ${media.phone`
    display: none;
  `}
`;

function NudgeText({ onClick }) {
  const [nudgeVisible, setNudgeVisible] = useState(false);
  const theme = useContext(ThemeContext);
  const nudgeProps = useSpring({ opacity: nudgeVisible ? 1 : 0 });

  const scrollListener = () => {
    const position = window.pageYOffset || document.documentElement.scrollTop;
    /*
      Hide the button if scrolling down,
      show it if scrolling up
    */
    setNudgeVisible(position < 15);
  };

  useEffect(() => {
    const position = window.pageYOffset || document.documentElement.scrollTop;
    setNudgeVisible(position < 15);
    document.addEventListener('scroll', scrollListener);
    return () => document.removeEventListener('scroll', scrollListener);
  }, []);

  return (
    <Container
      onClick={onClick}
      style={{
        ...nudgeProps,
      }}
    >
      <svg
        width="100%"
        height="100%"
        viewBox="0 0 200 200"
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
      >
        <g id="" stroke="none" strokeWidth="1" fill="none">
          <g id="nudge-text" fill={theme.theme.titleColor}>
            <path
              d="M53.936204,3.91363216 C55.952204,5.97863216 57.867204,8.15963216 59.214204,10.7136322 C63.408204,18.6676322 66.769204,26.9236322 67.897204,35.9446322 C68.293204,39.1186322 68.744204,42.2846322 68.637204,45.4986322 C68.581204,52.7426322 67.356204,59.7956322 65.156204,66.6956322 C62.578204,74.7736322 59.491204,82.6556322 55.914204,90.3366322 C54.705204,92.9346322 53.156204,95.3786322 51.665204,97.8346322 C51.277204,98.4766322 50.576204,98.9726322 49.931204,99.4006322 C49.366204,99.7756322 48.702204,99.6526322 48.146204,99.2366322 C47.551204,98.7926322 47.467204,98.1356322 47.692204,97.5266322 C47.965204,96.7846322 48.384204,96.0946322 48.773204,95.3986322 C49.784204,93.5856322 50.932204,91.8376322 51.817204,89.9656322 C55.849204,81.4326322 59.411204,72.7036322 61.919204,63.5926322 C65.373204,51.0436322 64.764204,38.6066322 60.442204,26.3576322 C59.539204,23.8016322 58.370204,21.3386322 57.317204,18.8366322 C56.067204,15.8666322 54.382204,13.1636322 52.313204,10.6966322 C51.697204,9.96263216 51.053204,9.24563216 50.493204,8.46963216 C49.512204,7.10763216 49.715204,5.51963216 50.984204,4.11463216 C51.838204,3.16863216 53.096204,3.05463216 53.936204,3.91363216 Z M39.297404,-17.5530678 C39.967404,-17.1290678 40.657404,-16.6840678 41.197404,-16.1150678 C43.440404,-13.7540678 46.218404,-12.1970678 49.039404,-10.6840678 C55.090404,-7.43906784 61.145404,-4.20106784 67.172404,-0.912067836 C69.273404,0.232932164 71.334404,1.46093216 73.349404,2.75193216 C75.154404,3.90893216 75.406404,5.38093216 74.249404,7.26293216 C74.003404,7.66393216 73.668404,8.02793216 73.313404,8.33893216 C72.675404,8.89993216 71.896404,9.14193216 71.103404,8.78293216 C70.233404,8.38993216 69.427404,7.85993216 68.589404,7.39793216 C60.481404,2.92393216 52.372404,-1.55006784 44.258404,-6.01506784 C43.843404,-6.24406784 43.383404,-6.39606784 42.935404,-6.56106784 C42.790404,-6.61406784 42.524404,-6.66006784 42.476404,-6.59106784 C42.306404,-6.35506784 42.045404,-6.02406784 42.105404,-5.80706784 C42.817404,-3.19406784 43.528404,-0.578067836 44.343404,2.00593216 C46.168404,7.79093216 48.006404,13.5719322 49.936404,19.3229322 C50.645404,21.4369322 50.096404,23.0469322 48.544404,24.4809322 C47.582404,25.3689322 46.253404,25.2139322 45.749404,24.0899322 C45.359404,23.2179322 45.000404,22.3269322 44.705404,21.4189322 C42.541404,14.7379322 40.420404,8.04293216 38.233404,1.36993216 C37.290404,-1.51006784 36.191404,-4.34006784 35.223404,-7.21206784 C34.663404,-8.86906784 33.953404,-10.5000678 34.002404,-12.3070678 C34.005404,-13.9580678 34.498404,-15.4440678 35.486404,-16.7700678 C36.422404,-18.0270678 37.990404,-18.3790678 39.297404,-17.5530678 Z"
              id="Fill-106"
              transform="translate(54.476146, 40.812436) rotate(-44.000000) translate(-54.476146, -40.812436) "
            ></path>
            <text
              id="What’s-with-the-name"
              transform="translate(123.500000, 139.000000) rotate(-29.000000) translate(-123.500000, -139.000000) "
              fontFamily="Caveat-Regular, Caveat"
              fontSize="35"
              fontWeight="normal"
            >
              <tspan x="50.3325" y="120">
                What’s with{' '}
              </tspan>
              <tspan x="62.915" y="165">
                the name?
              </tspan>
            </text>
          </g>
        </g>
      </svg>
    </Container>
  );
}

export default NudgeText;
